# dnsmasq Instructions

1. Within your `build/inventory.yaml` file, which was created with `make setup.<provider>` set the variable `tanzu_dns_provider: "local"`.

1. Within your `build/inventory.yaml` file, set the variable `tanzu_ingress_domain` to a domain name of your choosing.  Since this configuration is typically used for testing, the choice here is non-consequential.  Example: `tanzu_ingress_domain: "my.fake.domain.com"`

1. Continue setting up your `build/inventory.yaml`: [Quick Start: Provider Specific Steps](../QUICKSTART.md#provider-specific-steps)

1. [Deploy RPK](../QUICKSTART.md#deploy)

1. Start up a dnsmasq container with the `build/hosts` generated by the deployment of RPK:
```bash
# assumes you're in the repository root
docker run \
    --rm \
    --detach \
    --name rpk-localdns \
    -v `pwd`/build/hosts:/etc/hosts:ro \
    -p 53:53/tcp -p 53:53/udp \
    --cap-add=NET_ADMIN \
    andyshinn/dnsmasq:2.81
```

6. Set your local workstation's DNS resolver (DNS servers) to `127.0.0.1`.  See [Setting DNS Resolvers](setting-dns-resolvers.md) for details.

1. When finished testing, **DO NOT FORGET** to unset 127.0.0.1 as your DNS server and run:

```bash
docker stop rpk-localdns
```
